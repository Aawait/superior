class Login{constructor(e,t){this.loginUrl=e,this.registerUrl=t,this.userReg=new RegExp(/^[a-zA-Z0-9_-]{4,10}$/),this.passReg=new RegExp(/[a-zA-Z]{1}\w{5,17}/),this.init(this.loginUrl),this.register(this.registerUrl)}init(t){this.user=document.getElementById("username"),this.pass=document.getElementById("password"),this.btn=document.querySelector(".btn"),this.registerBtn=document.querySelector(".register"),this.userTest=document.querySelector(".userTest"),this.passTest=document.querySelector(".passTest"),this.btn.onclick=()=>{if(!this.userReg.test(this.user.value))return this.userTest.style.opacity=1,void(this.user.style.borderColor="#f00");if(!this.passReg.test(this.pass.value))return this.passTest.style.opacity=1,void(this.pass.style.borderColor="#f00");let e=new MyPromise({url:t,data:{username:this.user.value,password:this.pass.value}});e.then(e=>{(e=JSON.parse(e)).code?(window.alert("登录成功!即将跳转"),document.cookie=`user=${e.Hello};path=/`,location.href=localStorage.getItem("url")?localStorage.getItem("url"):`../index.html?user=${e.Hello}`):alert("用户名或密码错误,登录失败")})}}register(t){this.registerBtn.onclick=()=>{if(!this.userReg.test(this.user.value))return this.userTest.style.opacity=1,void(this.user.style.borderColor="#f00");if(!this.passReg.test(this.pass.value))return this.passTest.style.opacity=1,void(this.pass.style.borderColor="#f00");let e=new MyPromise({url:t,data:{username:this.user.value,password:this.pass.value}});e.then(e=>{(e=JSON.parse(e)).code||window.alert(e.state),window.alert(e.state+"!即将跳转"),document.cookie=`user=${e.Hello};path=/`,location.href=localStorage.getItem("url")?localStorage.getItem("url"):`../index.html?user=${e.Hello}`})}}}new Login("../api/login.php","../api/register.php");