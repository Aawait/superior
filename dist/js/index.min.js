class Search{constructor(t,e,i){this.box=document.querySelector(t),this.url=e,this.input=document.querySelector(i),this.init()}init(){this.input.oninput=()=>{const t=new RegExp(/'/);if(!t.test(this.input.value)){this.input.value?this.box.style.display="block":this.box.style.display="none";let t=new MyPromise({url:this.url,type:"POST",data:{key:this.input.value}});t.then(t=>{400!=(t=JSON.parse(t)).status&&this.render(t.data)})}}}render(t){let e="";(t=10<=t.length?t.filter((t,e)=>e<10):t).forEach(t=>{e+=`
            <li>
            <a href="./views/details.html?id=${t.id}" goods_id="${t.id}">${t.title}</a>
            </li>
            `}),this.box.innerHTML=e}}new Search(".search-ul","./api/search.php",".search-inp"),new Search(".float-ul","./api/search.php",".float-search");class MySwiper{constructor(){this.init()}init(){this.swiper=document.querySelector(".swiper-container"),this.btn=this.swiper.querySelectorAll(".swiper-button-white"),this.swiper.onmouseover=()=>{this.btn.forEach(t=>{t.classList.add("swiper-button-hide")})},this.swiper.onmouseout=()=>{this.btn.forEach(t=>{t.classList.remove("swiper-button-hide")})},new Swiper(".swiper-container",{direction:"horizontal",loop:!0,autoplay:{disableOnInteraction:!1,delay:4e3},speed:500,pagination:{el:".swiper-pagination",clickable:!0},navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"}})}}new MySwiper;class WheelGoods{constructor(t,e){this.box=document.querySelector(t),this.url=e,this.id=1.1,this.length=1e3,this.index=0,this.getData(this.url,this.id,this.length),this.render(),this.time()}time(){setInterval(()=>{this.box.innerHTML="",this.index+=3,this.render()},5e3)}async getData(t,e,i){i=await new MyPromise({url:t,type:"POST",data:{page:e,length:i}});localStorage.setItem("list",i),this.render()}render(){let e=JSON.parse(localStorage.getItem("list"));if(e){this.index>=e.data.length&&(this.index=0);let t=e.data.filter((t,e)=>e>=this.index&&e<this.index+3);t.forEach(t=>{this.box.innerHTML+=`
              <a href="./views/details.html?id=${t.id}" goods_id=${t.id}>
              <i>买一送一</i>
              <span>${t.title}</span>
              </a>
              `})}}}new WheelGoods(".wheel-list","./api/listData1.php");class GoodsList{constructor(t,e){this.box=document.querySelector(t),this.url=e,this.page=1,this.length=100,this.count=3500,this.init()}init(){new Pagination("#page",{pageInfo:{pagenum:1,pagesize:this.length,total:this.count,totalpage:Math.ceil(this.count/this.length)},textInfo:{first:"首页",prev:"上一页",next:"下一页",last:"尾页"},change:t=>{this.getData(this.url,t,this.length)}})}async getData(t,e,i){i=await new MyPromise({url:t,type:"POST",data:{page:e,length:i}}),i=JSON.parse(i);this.count=i.total.count,this.render(i.data)}render(t){let e="";const i=new RegExp(/\d+\.?\d{0,2}/);t.forEach(t=>{e+=`<a href="./views/details.html?id=${t.id}" class='list-item' goods_id="${t.id}" target="_blank">
             <div class='item-top'><img
                     src="${t.img}"
                     alt=""></div>
             <div class='item-down'>
                 <p class='item-title'>
                     <img src="https://cmsstatic.ffquan.cn/images/tmall.png?v=2021323305356" alt="" class="item-icon">
                     <span class='item-text'>${t.title}</span>
                 </p>
                 <p class='item-sale'>
                     <span>原价<i>${i.exec(t.old_price)[0]}</i></span>
                     <span>销量<i>${i.exec(t.sales)[0]}万</i></span>
                 </p>
                 <p class='item-price'>
                     <span>￥<i>${t.now_price}</i></span>
                     <span><i>${i.exec(t.cheap)[0]}</i>元券</span>
                 </p>
             </div>
         </a>`}),this.box.innerHTML=e}}new GoodsList(".list-content","./api/listData1.php");class FloatNav{constructor(t){this.ele=document.querySelector(t),this.init()}init(){this.hedaerTop=document.querySelector("#header").offsetHeight,this.navTop=document.querySelector("#nav").offsetHeight,this.search=document.querySelector(".float-search"),this.floatUl=document.querySelector(".float-ul"),window.addEventListener("scroll",t=>{window.scrollY>=this.hedaerTop+this.navTop?(this.ele.style.height="50px",this.ele.style.opacity=1):(this.ele.style.height=0,this.ele.style.opacity=0,this.search.value="",this.floatUl.style.display="none")})}}new FloatNav("#hide-nav");class Adgoods{constructor(t,e){this.box=document.querySelector(t),this.url=e,this.id=1.1,this.length=1e3,this.index=0,this.getData(this.url,this.id,this.length),this.init()}init(){this.btn=document.querySelector(".left-top-btn"),this.btn.onclick=()=>{this.index+=4,this.render()},this.seeMore=document.querySelector(".left-see-more"),this.seeMore.onclick=()=>{window.scrollTo(0,7700)},setInterval(()=>{this.index+=4,this.render()},1e4)}async getData(t,e,i){i=await new MyPromise({type:"POST",url:t,data:{page:e,length:i}});localStorage.setItem("list",i),this.render()}render(){let i=JSON.parse(localStorage.getItem("list"));if(i){this.index>=i.data.length&&(this.index=0);let t=i.data.filter((t,e)=>e>=this.index&&e<this.index+4),e="";const s=new RegExp(/\d+\.?\d{0,2}/);t.forEach(t=>{e+=`
           <a href="./views/details.html?id=${t.id}" class='left-top-item' goods_id="${t.id}">
                <div class='top-item-left'>
                    <img src="${t.img}"
                        alt="">
                </div>
                <div class='top-item-right'>
                    <p class='item-right-title'>${t.title}</p>
                    <p class='item-right-icon'>
                        <span class='half-price'>第二件半价</span>
                        <span class='hot-buy'>火热爆款</span>
                        <span class='rob-buy'>品牌抢购</span>
                    </p>
                    <p class='item-right-price'>
                        <span>￥${s.exec(t.now_price)[0]}</span>
                        <b>￥${s.exec(t.old_price)[0]}</b>
                    </p>
                </div>
            </a>
           `,this.box.innerHTML=e})}}}new Adgoods(".left-top-goods","./api/listData1.php");class CountDown{constructor(t){this.ele=document.querySelector(t),this.endTime=(new Date).getTime()+864e5,this.init(),this.getTime()}init(){this.hours=this.ele.querySelector(".title-time-hours"),this.minutes=this.ele.querySelector(".title-time-minutes"),this.seconds=this.ele.querySelector(".title-time-seconds")}getTime(){setInterval(()=>{var t=Date.now(),e=(this.endTime-t)/1e3,i=parseInt(e%60),t=Math.floor(e/60%60),e=Math.floor(e/60/60);this.seconds.innerText=i<10?"0"+i:i,this.minutes.innerText=t<10?"0"+t:t,this.hours.innerText=e<10?"0"+e:e},1e3)}}new CountDown(".ad-title-time");class AdList{constructor(t,e){this.box=document.querySelector(t),this.url=e,this.id=1.1,this.length=1e3,this.index=200,this.getData(this.url,this.id,this.length),this.init()}init(){let t=new Date;0==t.getHours()&&(this.index+=5,this.render())}async getData(t,e,i){i=await new MyPromise({url:t,type:"POST",data:{page:e,length:i}});localStorage.setItem("list",i),this.render()}render(){let s=JSON.parse(localStorage.getItem("list"));if(s){this.index>=s.data.length&&(this.index=200);let t=s.data.filter((t,e)=>e>=this.index&&e<this.index+5),e="";const n=new RegExp(/\d+\.?\d{0,2}/);let i=2;t.forEach(t=>{i++,e+=`
            <a href="./views/details.html?id=${t.id}" class='downUp-item' goods_id="${t.id}">
                 <div class='downUp-item-img'>
                     <img src="${t.img}"
                         alt="">
                 </div>
                 <div class='ad-item-content'>
                     <p>${t.title}</p>
                     <span>近两小时疯抢<b>${n.exec(t.sales)[0]}万</b>件</span>
                     <div class='item-content-price'>
                         <span>￥${t.now_price}</span>
                         <span>${t.cheap}</span>
                     </div>
                 </div>
                 <span class='downUp-item-icon'><i>${i}</i></span>
             </a>
            `}),this.box.innerHTML=e}}}new AdList(".ad-left-downUp","./api/listData1.php");class BackTop{constructor(t){this.btn=document.querySelector(t),this.init()}init(){this.bannerTop=document.querySelector(".banner").offsetHeight,this.hedaerTop=document.querySelector("#header").offsetHeight,this.navTop=document.querySelector("#nav").offsetHeight,this.scrollTop=this.bannerTop+this.hedaerTop+this.navTop,window.addEventListener("scroll",t=>{window.scrollY>=this.scrollTop?this.btn.style.height="50px":this.btn.style.height=0}),this.btn.onclick=()=>{window.scrollTo(0,0)}}}new BackTop(".back-top");class LoginBtn{constructor(t){this.btn=document.querySelector(t),this.init()}init(){let t=document.cookie;var e;t?(e=t.split("=")[1],this.btn.innerText=`欢迎您，${e}`,this.btn.setAttribute("href","#")):this.btn.innerText="你好请登录"}}new LoginBtn(".login-btn");class Page{constructor(t){this.box=document.querySelector(t),this.init(this.box)}init(t){t.onclick=t=>{((t=t||window.event).target.classList.contains("first")||t.target.classList.contains("prev"))&&window.scrollTo(0,1400),(t.target.classList.contains("next")||t.target.classList.contains("last"))&&window.scrollTo(0,1400),"P"!=t.target.nodeName&&"BUTTON"!=t.target.nodeName||window.scrollTo(0,1400)}}}new Page("#page");